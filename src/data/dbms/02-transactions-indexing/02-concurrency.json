{
  "id": "concurrency",
  "heading": "Concurrency Control & Locking â€“ Deep Dive",
  "blocks": [
    {
      "text": "In multi-user databases, multiple transactions can access data simultaneously. Concurrency control ensures correctness without sacrificing performance."
    },
    {
      "list": [
        "Problems without concurrency control: Lost Updates, Dirty Reads, Non-Repeatable Reads, Phantom Reads",
        "Locking Mechanisms: Shared locks, Exclusive locks, Two-Phase Locking (2PL)",
        "Isolation Levels: Read Uncommitted, Read Committed, Repeatable Read, Serializable"
      ]
    },
    {
      "image": {
        "src": "https://via.placeholder.com/800x400?text=Concurrency+Issues",
        "alt": "Concurrency Problems",
        "caption": "Visualization of common concurrency issues in multi-user environments."
      }
    },
    {
      "text": "Example: Two users try to update the same account balance simultaneously. Locks ensure only one completes first, maintaining consistency."
    },
    {
      "code": [
        {
          "language": "sql",
          "content": "SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;\nBEGIN TRANSACTION;\nUPDATE Accounts SET balance = balance - 100 WHERE account_id = 101;\nCOMMIT;"
        }
      ]
    },
    {
      "badge": "success",
      "title": "Pro Tip",
      "text": "Higher isolation levels reduce anomalies but may decrease concurrency. DBAs balance between consistency and throughput."
    },
    {
      "list": [
        "Deadlocks: Two transactions waiting for each other indefinitely",
        "Deadlock Prevention: Timeouts or wait-die schemes",
        "Optimistic Concurrency Control: Check for conflicts at commit time instead of using locks"
      ]
    },
    {
      "text": "Mini Exercise: How would you handle multiple users booking the last seat on a flight at the same time?"
    },
    {
      "image": {
        "src": "https://via.placeholder.com/800x400?text=Deadlock+Graph",
        "alt": "Deadlock Example",
        "caption": "Deadlock scenario visualization showing wait-for graph."
      }
    }
  ]
}
